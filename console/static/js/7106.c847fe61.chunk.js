"use strict";(self.webpackChunkself_hosted_console=self.webpackChunkself_hosted_console||[]).push([[7106],{57424:function(n,e,t){t.d(e,{GJ:function(){return l},TA:function(){return d},iZ:function(){return s},ld:function(){return u}});var i=t(1413),r=t(40056),a=t(99902),o=t(48857),l=function(n){var e=(0,a.g)().get;return(0,r.useQuery)([o.iP.AuthorizerInstances],(function(){return e({path:"authorizers"})}),(0,i.Z)((0,i.Z)({},n),{},{enabled:null===n||void 0===n?void 0:n.enabled,retry:!1,staleTime:1/0}))},d=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,o.Jb)(n),t=(0,a.g)().post,l=(0,r.useQueryClient)();return(0,r.useMutation)([o.ff.AddAuthorizerInstance],(function(n){return t({body:n,path:"authorizers"})}),(0,i.Z)((0,i.Z)({},e),{},{onSuccess:function(n,t){var i;l.invalidateQueries([o.iP.AuthorizerInstances]),l.removeQueries([o.iP.IsAuthorizerInstanceNameAvailable,n.name]),null===e||void 0===e||null===(i=e.onSuccess)||void 0===i||i.call(e,n,t)}}))},u=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,r.useQueryClient)(),t=(0,o.Jb)(n,o.iP.PoliciesData),l=(0,a.g)().del;return(0,r.useMutation)((function(n){return l({path:"authorizers/".concat(n)})}),(0,i.Z)((0,i.Z)({},t),{},{onSuccess:function(n,i){var r;e.removeQueries([o.iP.AuthorizerInstances]),null===t||void 0===t||null===(r=t.onSuccess)||void 0===r||r.call(t,n,i)}}))},s=function(n,e){var t=(0,a.g)().get;return(0,r.useQuery)([o.iP.IsAuthorizerInstanceNameAvailable,n],(function(){return t({path:"authorizers/available/".concat(n)})}),(0,i.Z)((0,i.Z)({},e),{},{enabled:!!n&&(null===e||void 0===e?void 0:e.enabled),retry:!1,staleTime:1/0}))}},76479:function(n,e,t){t.d(e,{Z:function(){return z}});var i,r,a,o,l=t(29439),d=t(47313),u=t(19178),s=t(57424),c=function(){return(0,d.useMemo)((function(){var n=function(n,e){var t=(0,s.iZ)(n,{enabled:n!==e});return(0,d.useMemo)((function(){var n,e,i;return{isAvailable:!(null!==t&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.availability)||"NAME_AVAILABILITY_AVAILABLE"===(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.availability),reason:(0,u.AP)(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.reason)}}),[null===t||void 0===t?void 0:t.data])};return function(e,t){return(0,d.useMemo)((function(){return(0,u.wL)(n)}),[])(e,t)}}),[])},h=/^[a-z][a-z0-9-]{3,29}$/,f=/^[a-z][a-z0-9-]{0,29}$/,v=function(n){return h.test(n)?"VALID":0===n.length||f.test(n)?"VALID_FRAGMENT":"INVALID"},x={getValidityOf:v,isValid:function(n){return"VALID"===v(n)},ruleText:"Start with a letter. Must be 4 to 30 lowercase alphanumeric characters or dashes."},p=t(30168),y=t(25235),b=y.ZP.div(i||(i=(0,p.Z)(["\n  padding: 20px;\n  width: 100%;\n"]))),j=y.ZP.div(r||(r=(0,p.Z)(["\n  margin-top: 18px;\n"]))),m=y.ZP.div(a||(a=(0,p.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  margin: 12px auto;\n"]))),Z=y.ZP.div(o||(o=(0,p.Z)(["\n  width: 100%;\n  flex: 1 1 0%;\n  justify-content: flex-end;\n  align-items: flex-end;\n  float: right;\n  display: flex;\n  margin-top: 20px;\n  button:first-of-type {\n    margin-right: 10px;\n  }\n"]))),g=t(46417),z=function(n){var e=n.authorizerInstance,t=n.show,i=n.onHide,r=(0,d.useState)(""),a=(0,l.Z)(r,2),o=a[0],h=a[1],f=(0,d.useState)(""),v=(0,l.Z)(f,2),p=v[0],y=v[1],z=(0,d.useState)(""),A=(0,l.Z)(z,2),w=A[0],C=A[1],I=function(){h(""),y(""),C("")},P=(0,u.dV)(),k=(0,s.TA)({onError:function(n){P(n)}}).mutate;return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(u.AY,{cardHeight:"100%",show:t,title:"Connect an authorizer",onHide:function(){I(),i()},children:(0,g.jsxs)(b,{className:"add-a-authorizer-modal-content",children:[(0,g.jsx)("div",{children:"Provide a unique name and click the Add button."}),(0,g.jsxs)(j,{children:[(0,g.jsx)(m,{children:(0,g.jsx)(u.as,{defaultValue:null===e||void 0===e?void 0:e.name,disabled:!(null===e||void 0===e||!e.name),label:"Instance Name",useIsAvailable:c(),validator:x,value:null===e||void 0===e?void 0:e.name,onChange:function(n){return h(n||"")}})}),(0,g.jsx)(m,{children:(0,g.jsx)(u.as,{label:"Instance URL",value:null===e||void 0===e?void 0:e.url,onChange:function(n){return y(n||"")}})}),(0,g.jsx)(m,{children:(0,g.jsx)(u.as,{label:"API Key (Optional)",type:"password",value:null===e||void 0===e?void 0:e.apiKey,onChange:function(n){return C(n||"")}})})]}),(0,g.jsxs)(Z,{children:[(0,g.jsx)(u.zx,{"data-testid":"cancel-btn",variant:"secondary",onClick:function(){I(),i()},children:"Cancel"}),(0,g.jsx)(u.zx,{"data-testid":"add-authorizer-modal-btn",disabled:""===o||""===p,id:"add-authorizer",onClick:function(){i(),k({name:o,url:p,apiKey:w})},children:"Save"})]})]})})})}},17106:function(n,e,t){t.r(e),t.d(e,{default:function(){return L}});var i,r,a,o,l,d,u,s,c,h=t(29439),f=t(92229),v=t.n(f),x=t(47313),p=t(58467),y=t(19178),b=t(57424),j=t(30168),m=t(25235),Z=m.ZP.div(i||(i=(0,j.Z)(["\n  padding: 20px;\n  width: 100%;\n  height: fit-content;\n"]))),g=m.ZP.div(r||(r=(0,j.Z)(["\n  font-size: 16px;\n"]))),z=(m.ZP.div(a||(a=(0,j.Z)(["\n  display: flex;\n  font-weight: ",";\n"])),(function(n){return n.bold?"bold":500})),m.ZP.div(o||(o=(0,j.Z)(["\n  input {\n    width: 600px;\n  }\n"]))),m.ZP.div(l||(l=(0,j.Z)(["\n  width: 100%;\n  flex: 1 1 0%;\n  justify-content: flex-start;\n  align-items: flex-start;\n  float: right;\n  display: flex;\n  margin-top: 60px;\n  button:first-of-type {\n    margin-right: 10px;\n  }\n"])))),A=t(46417),w=function(n){var e=n.onHide,t=n.show,i=n.subject,r=n.onClickRemove,a=e;return(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(y.AY,{cardHeight:"100%",show:t,title:"Delete ".concat(i),variant:"delete_danger",onHide:a,children:(0,A.jsxs)(Z,{children:[(0,A.jsxs)(g,{children:["Are you sure you want to delete your ",i,"?"]}),(0,A.jsxs)(z,{children:[(0,A.jsx)(y.zx,{variant:"secondary",onClick:a,children:"Cancel"}),(0,A.jsx)(y.zx,{"data-testid":"delete-subject",variant:"danger",onClick:r,children:"Delete"})]})]})})})},C=t(76479),I=(m.ZP.div(d||(d=(0,j.Z)(["\n  font-weight: ",";\n  font-size: ",";\n  color: ",";\n  padding-top: 8px;\n"])),(function(n){return n.bold?"bold":100}),(function(n){return n.size}),(function(n){return n.color})),m.ZP.div(u||(u=(0,j.Z)(["\n  padding-left: 90px;\n  display: block;\n"])))),P=m.ZP.div(s||(s=(0,j.Z)(["\n  font-family: Roboto;\n  width: 130px;\n  padding-bottom: 20px;\n  display: flex;\n  justify-content: space-between;\n"]))),k=function(n){var e=n.authorizerInstance,t=(0,x.useState)(!1),i=(0,h.Z)(t,2),r=i[0],a=i[1],o=(0,x.useState)(!1),l=(0,h.Z)(o,2),d=l[0],u=l[1],s=(0,x.useState)(!1),c=(0,h.Z)(s,2),f=c[0],v=c[1],j=(0,y.dV)(),m=(0,p.s0)(),Z=(0,b.ld)({onSuccess:function(){m("/ui/authorizers")},onError:function(n){v(!1),j(n)},onMutate:function(){return v(!0)}}).mutateAsync;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(y.cC,{show:f}),(0,A.jsx)(C.Z,{authorizerInstance:e,show:d,onHide:function(){return u(!1)}}),(0,A.jsx)(w,{redirectUrl:"/",show:r,subject:"Authorizer",onClickRemove:function(){return n=e.name,void Z(n);var n},onHide:function(){return a(!1)}}),(0,A.jsx)(I,{children:(0,A.jsxs)(P,{children:[(0,A.jsx)(y.zx,{"data-testid":"add-authorizer-btn",id:"add-a-authorizer",onClick:function(){u(!0)},children:"Edit"}),(0,A.jsx)(y.zx,{"data-testid":"delete-authorizer",disabled:!e||r,variant:"danger",onClick:function(){a(!0)},children:"Delete"})]})})]})},S=t(58126),V=t(85791),D=m.ZP.div(c||(c=(0,j.Z)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: 1rem 6rem;\n  input {\n    width: 700px;\n  }\n  label {\n    font-size: 14px;\n  }\n"]))),L=function(){var n=(0,p.UO)().id,e=(0,S.z)(),t=e.asertoDirectoryUrl,i=e.directoryApiKey,r=e.directoryTenantId,a=(0,x.useState)(""),o=(0,h.Z)(a,2),l=o[0],d=o[1],u=(0,x.useState)(""),s=(0,h.Z)(u,2),c=s[0],f=s[1],j=(0,b.GJ)().data,m=(0,x.useMemo)((function(){return(null===j||void 0===j?void 0:j.results)||[]}),[null===j||void 0===j?void 0:j.results]),Z=(0,x.useMemo)((function(){return null===m||void 0===m?void 0:m.find((function(e){return e.name===n}))}),[m,n]);return(0,x.useEffect)((function(){f((null===Z||void 0===Z?void 0:Z.apiKey)||""),d((null===Z||void 0===Z?void 0:Z.url)||"")}),[Z]),(0,A.jsx)(V.Z,{children:(0,A.jsxs)("div",{children:[(0,A.jsx)(D,{children:(0,A.jsx)(y.Gc,{defaultValue:n,disabled:!0,label:"Authorizer Instance Name",readOnly:!0,onClickCopy:v()})}),(0,A.jsx)(D,{children:(0,A.jsx)(y.Gc,{disabled:!0,label:"Authorizer Service URL",readOnly:!0,value:l,onClickCopy:v()})}),(0,A.jsx)(D,{hidden:!c,children:(0,A.jsx)(y.Gc,{disabled:!0,label:"Authorizer API key",placeholder:"****************************************************************",readOnly:!0,shouldShowHideShowButton:!0,type:"password",value:c,onClickCopy:v()})}),(0,A.jsx)(D,{children:(0,A.jsx)(y.Gc,{defaultValue:t,disabled:!0,label:"Directory Service URL",onClickCopy:v()})}),i&&""!==i&&(0,A.jsx)(D,{children:(0,A.jsx)(y.Gc,{defaultValue:i,disabled:!0,label:"Directory API key",placeholder:"****************************************************************",shouldShowHideShowButton:!0,type:"password",onClickCopy:v()})}),r&&""!==r&&(0,A.jsx)(D,{children:(0,A.jsx)(y.Gc,{defaultValue:r,disabled:!0,label:"Directory Tenant ID",onClickCopy:v()})}),(0,A.jsx)(k,{authorizerInstance:{apiKey:c,name:n,url:l}})]})})}}}]);